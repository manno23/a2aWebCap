# Message Flow Visualization with Color-Coded Event Tracking

This document shows detailed request/response flows with both WebSocket/HTTP and RPC layer information, color-coded by event type.

## Color Coding Legend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COLOR LEGEND                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ Connection Events:                                                           â”‚
â”‚   ğŸ”µ BLUE    - TCP/WebSocket connection establishment                        â”‚
â”‚   ğŸŸ¢ GREEN   - Successful connection/handshake                               â”‚
â”‚   ğŸ”´ RED     - Connection errors/failures                                    â”‚
â”‚   âš« BLACK   - Connection termination                                        â”‚
â”‚                                                                              â”‚
â”‚ RPC Layer:                                                                   â”‚
â”‚   ğŸŸ¡ YELLOW  - RPC request sent                                              â”‚
â”‚   ğŸŸ  ORANGE  - RPC response received                                         â”‚
â”‚   ğŸŸ£ PURPLE  - RPC error/exception                                           â”‚
â”‚   ğŸ”· CYAN    - RPC method invocation (server-side)                           â”‚
â”‚                                                                              â”‚
â”‚ A2A Protocol:                                                                â”‚
â”‚   ğŸŸ¢ GREEN   - Task created (submitted state)                                â”‚
â”‚   ğŸŸ¡ YELLOW  - Task working (processing)                                     â”‚
â”‚   ğŸ”µ BLUE    - Status update event                                           â”‚
â”‚   ğŸŸ£ PURPLE  - Artifact update event                                         â”‚
â”‚   âœ… GREENâœ“  - Task completed successfully                                   â”‚
â”‚   âŒ REDâœ—    - Task failed/rejected                                          â”‚
â”‚   â¸ï¸  GRAY    - Task canceled                                                â”‚
â”‚                                                                              â”‚
â”‚ HTTP/WebSocket:                                                              â”‚
â”‚   ğŸ“¤ CYAN    - Outgoing message/frame                                        â”‚
â”‚   ğŸ“¥ MAGENTA - Incoming message/frame                                        â”‚
â”‚   ğŸ” ORANGE  - Authentication/authorization                                  â”‚
â”‚   âš ï¸  YELLOW  - Warning/non-critical error                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example 1: Simple sendMessage() Flow

### Client-Server Diagram
```
Client                                                          Server
  â”‚                                                               â”‚
  â”‚ app.sendMessage({role: 'user', text: 'Hello'})                â”‚
  â”‚                                                               â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚ â”‚ RPC Stub Layer                                          â”‚  â”‚
  â”‚ â”‚ â€¢ Generate ID: 550e8400-e29b-41d4-a716-446655440000     â”‚  â”‚
  â”‚ â”‚ â€¢ Create request object                                  â”‚  â”‚
  â”‚ â”‚ â€¢ Register promise handler                               â”‚  â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ WS Frame (text) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”¤
  â”‚                                                               â”‚
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ Parse JSONâ”‚
  â”‚                                                         â”‚ Route RPC â”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ sendMessage() â”‚
  â”‚                                                         â”‚ â€¢ Create task â”‚
  â”‚                                                         â”‚ â€¢ Process msg â”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ Serialize â”‚
  â”‚                                                         â”‚ response  â”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
  â”‚                                                               â”‚
  â”œâ—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ WS Frame (text) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                               â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚ â”‚ RPC Stub Layer                                          â”‚  â”‚
  â”‚ â”‚ â€¢ Match response ID to pending request                   â”‚  â”‚
  â”‚ â”‚ â€¢ Resolve promise                                        â”‚  â”‚
  â”‚ â”‚ â€¢ Return Task object to caller                           â”‚  â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                               â”‚
  â–¼ app receives Task object                                      â–¼
```

### Color-Coded Event List

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT LOG: sendMessage() Call                                                â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ #  â”‚ TIME     â”‚ TYPE     â”‚ EVENT DETAILS                                     â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 01 â”‚ 00:00.00 â”‚ ğŸŸ¡ RPC   â”‚ CLIENT â†’ RPC Request Generated                     â”‚
â”‚    â”‚          â”‚    REQ   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Request ID: 550e8400-e29b-41d4-a716-44665544  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Method: sendMessage                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Timeout: 30000ms                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Promise: pending                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 02 â”‚ 00:00.01 â”‚ ğŸ“¤ WS    â”‚ CLIENT â†’ WebSocket Frame Sent                      â”‚
â”‚    â”‚          â”‚    OUT   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ WebSocket Protocol:                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   FIN: 1 (final frame)                         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Opcode: 0x1 (text)                           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Mask: Yes (client-to-server)                 â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Length: 387 bytes                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   MaskKey: [0x12, 0x34, 0x56, 0x78]           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ JSON-RPC Payload:                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ {                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "id": "550e8400-e29b-41d4-a716-446655440000",â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "method": "sendMessage",                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "params": {                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "message": {                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       "messageId": "msg-001",                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       "role": "user",                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       "parts": [                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚         {                                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚           "kind": "text",                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚           "text": "Hello, A2A server!"         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚         }                                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       ]                                        â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     }                                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   }                                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 03 â”‚ 00:00.02 â”‚ ğŸ“¥ WS    â”‚ SERVER â† WebSocket Frame Received                 â”‚
â”‚    â”‚          â”‚    IN    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Frame validated and unmasked                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Payload length: 387 bytes                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Parsed as JSON successfully                    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 04 â”‚ 00:00.03 â”‚ ğŸ”· RPC   â”‚ SERVER â†’ RPC Method Invoked                        â”‚
â”‚    â”‚          â”‚   INVOKE â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Method: A2AService.sendMessage()               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Parameters deserialized:                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   - message: Message (valid)                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   - config: undefined                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Context: unauthenticated                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 05 â”‚ 00:00.04 â”‚ ğŸŸ¢ TASK  â”‚ SERVER â†’ Task Created                              â”‚
â”‚    â”‚          â”‚   CREATE â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Task ID: task-7f8a9b2c-3d4e-5f6a-7b8c-9d0e1f  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Context ID: ctx-auto-generated-001             â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Initial State: submitted                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Timestamp: 2025-11-14T09:45:23.045Z           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ History: [Message msg-001]                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 06 â”‚ 00:00.05 â”‚ ğŸ”µ STATUSâ”‚ SERVER â†’ Task State Transition                     â”‚
â”‚    â”‚          â”‚   UPDATE â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Task ID: task-7f8a9b2c...                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ State: submitted â†’ working                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event emitted to TaskManager listeners         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 07 â”‚ 00:00.06 â”‚ ğŸ”· RPC   â”‚ SERVER â†’ Async Processing Started                  â”‚
â”‚    â”‚          â”‚   ASYNC  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ processMessage() spawned asynchronously        â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Main RPC call returning Task immediately       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ (Non-blocking response pattern)                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 08 â”‚ 00:00.07 â”‚ ğŸŸ  RPC   â”‚ SERVER â†’ RPC Response Serialized                   â”‚
â”‚    â”‚          â”‚   RESP   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Response Object:                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ {                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "id": "550e8400-e29b-41d4-a716-446655440000",â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "result": {                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "id": "task-7f8a9b2c-3d4e-5f6a-...",       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "kind": "task",                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "contextId": "ctx-auto-generated-001",     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "status": {                                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       "state": "working",                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚       "timestamp": "2025-11-14T09:45:23.050Z"  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     },                                         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "history": [...]                           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   }                                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 09 â”‚ 00:00.08 â”‚ ğŸ“¤ WS    â”‚ SERVER â†’ WebSocket Frame Sent                      â”‚
â”‚    â”‚          â”‚    OUT   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ WebSocket Protocol:                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   FIN: 1                                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Opcode: 0x1 (text)                           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Mask: No (server-to-client)                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   Length: 542 bytes                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Payload: JSON-RPC response (above)             â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 10 â”‚ 00:00.09 â”‚ ğŸ“¥ WS    â”‚ CLIENT â† WebSocket Frame Received                  â”‚
â”‚    â”‚          â”‚    IN    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Frame validated                                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Parsed as JSON                                 â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Identified as RPC response (has "id" field)    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 11 â”‚ 00:00.10 â”‚ ğŸŸ  RPC   â”‚ CLIENT â†’ Promise Resolved                          â”‚
â”‚    â”‚          â”‚   DONE   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Matched ID: 550e8400-e29b-41d4-a716-446655...  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Cleared timeout timer                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Removed from pendingRequests map               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Resolved promise with Task object              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Duration: 10ms                                 â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 12 â”‚ 00:00.11 â”‚ âœ… APP   â”‚ CLIENT â†’ Application Received Task                 â”‚
â”‚    â”‚          â”‚   RETURN â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ const task = await client.sendMessage(...)     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ task.id: "task-7f8a9b2c..."                    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ task.status.state: "working"                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚    â”‚          â”‚          â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚    â”‚          â”‚          â”‚ â•‘ ASYNC PROCESSING (runs in background)        â•‘ â”‚
â”‚    â”‚          â”‚          â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 13 â”‚ 00:00.11 â”‚ ğŸŸ¡ TASK  â”‚ SERVER â†’ Processing Message                        â”‚
â”‚    â”‚          â”‚  PROCESS â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ processMessage() executing                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Simulated delay: 100ms                         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 14 â”‚ 00:00.21 â”‚ ğŸ”µ STATUSâ”‚ SERVER â†’ Task State Transition                     â”‚
â”‚    â”‚          â”‚  UPDATE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Task ID: task-7f8a9b2c...                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ State: working â†’ completed                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Response added to history                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event emitted (final=true)                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total Duration: 210ms (11ms for RPC roundtrip, 199ms async processing)
```

## Example 2: Streaming Message Flow

### Client-Server Diagram

```
Client                                                          Server
  â”‚                                                               â”‚
  â”‚ sendMessageStreaming({text: 'Stream test'}, null, callback)   â”‚
  â”‚                                                               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RPC: sendMessageStreaming â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”¤
  â”‚                                                               â”‚
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ Create Taskâ”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ StreamingTask  â”‚
  â”‚                                                         â”‚ (RpcTarget)    â”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                               â”‚
  â”œâ—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ StreamingTask stub returned â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                               â”‚
  â”‚ streamingTask.subscribe(callback)                             â”‚
  â”‚                                                               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RPC: subscribe(callback) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”¤
  â”‚                                                               â”‚
  â”‚                                                         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                         â”‚ Register       â”‚
  â”‚                                                         â”‚ callback       â”‚
  â”‚                                                         â”‚ Start monitor  â”‚
  â”‚                                                         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                               â”‚
  â”œâ—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Push: onStatusUpdate(submitted) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  callback.onStatusUpdate({state: 'submitted', final: false})  â”‚
  â”‚                                                               â”‚
  â”œâ—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Push: onStatusUpdate(working) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  callback.onStatusUpdate({state: 'working', final: false})    â”‚
  â”‚                                                               â”‚
  â”‚                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                       â”‚ Processing...  â”‚
  â”‚                                                       â”‚ (100ms delay)  â”‚
  â”‚                                                       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                               â”‚
  â”œâ—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Push: onStatusUpdate(completed) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  callback.onStatusUpdate({state: 'completed', final: true})   â”‚
  â”‚                                                               â”‚
  â–¼                                                               â–¼
Done                                                       Monitoring stopped
```

### Color-Coded Event List

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT LOG: sendMessageStreaming() with Push Notifications                   â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ #  â”‚ TIME     â”‚ TYPE     â”‚ EVENT DETAILS                                     â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 01 â”‚ 00:00.00 â”‚ ğŸŸ¡ RPC   â”‚ CLIENT â†’ sendMessageStreaming() Request            â”‚
â”‚    â”‚          â”‚    REQ   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Request ID: a1b2c3d4-e5f6-7890-abcd-ef123456   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Method: sendMessageStreaming                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Params: {message, config, callback}            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 02 â”‚ 00:00.05 â”‚ ğŸ”· RPC   â”‚ SERVER â†’ Method Invoked                            â”‚
â”‚    â”‚          â”‚  INVOKE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ A2AService.sendMessageStreaming() called       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Creating task and StreamingTask stub           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 03 â”‚ 00:00.06 â”‚ ğŸŸ¢ TASK  â”‚ SERVER â†’ Task Created                              â”‚
â”‚    â”‚          â”‚  CREATE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Task ID: task-stream-001                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ State: submitted                               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 04 â”‚ 00:00.07 â”‚ ğŸ”µ STATUSâ”‚ SERVER â†’ Task State Transition                     â”‚
â”‚    â”‚          â”‚  UPDATE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ State: submitted â†’ working                     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event emitted to TaskManager                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 05 â”‚ 00:00.08 â”‚ ğŸŸ£ STREAMâ”‚ SERVER â†’ StreamingTask Created                     â”‚
â”‚    â”‚          â”‚    STUB  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ StreamingTask extends RpcTarget                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Stub ID: stub-stream-abc123                    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Methods: subscribe(), unsubscribe(), getTask() â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Callback registered if provided                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 06 â”‚ 00:00.09 â”‚ ğŸŸ  RPC   â”‚ SERVER â†’ RPC Response (StreamingTask stub)         â”‚
â”‚    â”‚          â”‚    RESP  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ {                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "id": "a1b2c3d4-e5f6-7890-abcd-ef123456",    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "result": {                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "__capnweb_stub__": true,                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "stubId": "stub-stream-abc123",            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "methods": ["subscribe", "getTask", ...]   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   }                                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 07 â”‚ 00:00.10 â”‚ ğŸŸ  RPC   â”‚ CLIENT â† StreamingTask Stub Received               â”‚
â”‚    â”‚          â”‚    DONE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Local stub proxy created                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ streamingTask = new StreamingTaskProxy(...)    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Methods available: subscribe(), getTask()      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 08 â”‚ 00:00.15 â”‚ ğŸŸ¡ RPC   â”‚ CLIENT â†’ subscribe(callback) Call                  â”‚
â”‚    â”‚          â”‚    REQ   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Request ID: b2c3d4e5-f678-90ab-cdef-123456     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Stub ID: stub-stream-abc123                    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Method: subscribe                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Params: {callback: <TaskUpdateCallback>}       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 09 â”‚ 00:00.20 â”‚ ğŸ”· RPC   â”‚ SERVER â†’ subscribe() Invoked                       â”‚
â”‚    â”‚          â”‚  INVOKE  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ StreamingTask.subscribe(callback)              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ â€¢ Callback added to callbacks Set              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ â€¢ Start monitoring task updates                â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ â€¢ Subscribe to TaskManager events              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 10 â”‚ 00:00.21 â”‚ ğŸ”µ PUSH  â”‚ SERVER â†’ Push onStatusUpdate (submitted)           â”‚
â”‚    â”‚          â”‚   STATUS â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Calling callback.onStatusUpdate()              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event: {                                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   type: 'status',                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   taskId: 'task-stream-001',                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   status: {state: 'submitted', ...},           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   final: false                                 â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ (Callback is RPC stub on client side)          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 11 â”‚ 00:00.22 â”‚ ğŸ“¤ RPC   â”‚ SERVER â†’ Push Notification Frame Sent              â”‚
â”‚    â”‚          â”‚   PUSH   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ WebSocket frame (server â†’ client push)         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ RPC method call (reverse direction!)           â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ {                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "method": "onStatusUpdate",                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   "params": {                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚     "event": {...}                             â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   }                                            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ No "id" field - this is a notification!        â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 12 â”‚ 00:00.23 â”‚ ğŸ“¥ RPC   â”‚ CLIENT â† Notification Received                     â”‚
â”‚    â”‚          â”‚   PUSH   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Parsed message has no "id" â†’ notification      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Routed to local callback handler               â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ callback.onStatusUpdate(event) invoked         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 13 â”‚ 00:00.25 â”‚ ğŸ”µ PUSH  â”‚ SERVER â†’ Push onStatusUpdate (working)             â”‚
â”‚    â”‚          â”‚   STATUS â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ TaskManager emitted state change event         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ StreamingTask forwarding to callbacks          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event: {state: 'working', final: false}        â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 14 â”‚ 00:00.26 â”‚ ğŸ“¥ RPC   â”‚ CLIENT â† Notification (working)                    â”‚
â”‚    â”‚          â”‚   PUSH   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ callback.onStatusUpdate({state: 'working', ...})â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚    â”‚          â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ [Processing... 100ms delay]                    â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 15 â”‚ 00:00.13 â”‚ ğŸŸ¡ TASK  â”‚ SERVER â†’ Message Processing Complete               â”‚
â”‚    â”‚          â”‚  PROCESS â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Response message added to task history         â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Task state transitioning to completed          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 16 â”‚ 00:00.13 â”‚ ğŸ”µ PUSH  â”‚ SERVER â†’ Push onStatusUpdate (completed, FINAL)    â”‚
â”‚    â”‚          â”‚   STATUS â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Event: {                                       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   state: 'completed',                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   final: TRUE                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ }                                              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ StreamingTask detects final state              â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Stopping task monitoring after this push       â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 17 â”‚ 00:00.14 â”‚ ğŸ“¥ RPC   â”‚ CLIENT â† Final Notification                        â”‚
â”‚    â”‚          â”‚   PUSH   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ callback.onStatusUpdate({                      â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   state: 'completed',                          â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚   final: true                                  â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ })                                             â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Client knows no more updates coming            â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â”‚ 18 â”‚ 00:00.15 â”‚ âœ… DONE  â”‚ Stream Complete                                    â”‚
â”‚    â”‚          â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Server: Unsubscribed from TaskManager events   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Server: Callback set cleared                   â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â”‚ Client: Can still call getTask() if needed     â”‚ â”‚
â”‚    â”‚          â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    â”‚          â”‚          â”‚                                                    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total Events: 18
Push Notifications: 3 (submitted, working, completed)
RPC Calls: 2 (sendMessageStreaming, subscribe)
Total Duration: 150ms
```

Next: See `advanced-scenarios-visualization.md` for authentication flows, error handling, and concurrent connections.
